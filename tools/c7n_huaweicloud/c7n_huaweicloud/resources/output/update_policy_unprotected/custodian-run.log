2025-03-22 10:22:05,949 - custodian.output - ERROR - Error while executing policy
Traceback (most recent call last):
  File "/root/huawei_custodian/cloud-custodian/c7n/policy.py", line 330, in run
    resources = self.policy.resource_manager.resources()
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 153, in resources
    resources = self._fetch_resources(q)
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 172, in _fetch_resources
    return self.augment(self.source.get_resources(query)) or []
                        ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 74, in get_resources
    return self.query.filter(self.manager, **query)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 28, in filter
    resources = self._pagination_limit_offset(m, enum_op, path)
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 36, in _pagination_limit_offset
    client = session.client(m.service)
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/client.py", line 69, in client
    return client
           ^^^^^^
UnboundLocalError: cannot access local variable 'client' where it is not associated with a value
2025-03-22 10:22:49,367 - custodian.output - ERROR - Error while executing policy
Traceback (most recent call last):
  File "/root/huawei_custodian/cloud-custodian/c7n/policy.py", line 330, in run
    resources = self.policy.resource_manager.resources()
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 153, in resources
    resources = self._fetch_resources(q)
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 172, in _fetch_resources
    return self.augment(self.source.get_resources(query)) or []
                        ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 74, in get_resources
    return self.query.filter(self.manager, **query)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 28, in filter
    resources = self._pagination_limit_offset(m, enum_op, path)
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 36, in _pagination_limit_offset
    client = session.client(m.service)
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/client.py", line 69, in client
    return client
           ^^^^^^
UnboundLocalError: cannot access local variable 'client' where it is not associated with a value
2025-03-22 10:23:34,975 - custodian.output - ERROR - Error while executing policy
Traceback (most recent call last):
  File "/root/huawei_custodian/cloud-custodian/c7n/policy.py", line 330, in run
    resources = self.policy.resource_manager.resources()
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 153, in resources
    resources = self._fetch_resources(q)
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 172, in _fetch_resources
    return self.augment(self.source.get_resources(query)) or []
                        ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 74, in get_resources
    return self.query.filter(self.manager, **query)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 28, in filter
    resources = self._pagination_limit_offset(m, enum_op, path)
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 36, in _pagination_limit_offset
    client = session.client(m.service)
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/client.py", line 69, in client
    return client
           ^^^^^^
UnboundLocalError: cannot access local variable 'client' where it is not associated with a value
2025-03-22 10:29:16,319 - custodian.output - ERROR - Error while executing policy
Traceback (most recent call last):
  File "/root/custodian/lib/python3.13/site-packages/huaweicloudsdkcore/http/http_client.py", line 127, in response_hook
    resp.raise_for_status()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "/root/custodian/lib/python3.13/site-packages/requests/models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 401 Client Error: Unauthorized for url: https://iam.myhuaweicloud.com/v3/projects?name=cn-east-3

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/custodian/lib/python3.13/site-packages/huaweicloudsdkcore/auth/credentials.py", line 274, in process_auth_params
    response = http_client.do_request_sync(self.process_auth_request(req, http_client).result())
  File "/root/custodian/lib/python3.13/site-packages/huaweicloudsdkcore/http/http_client.py", line 100, in do_request_sync
    self.response_error_hook_factory()(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/root/custodian/lib/python3.13/site-packages/huaweicloudsdkcore/http/http_client.py", line 129, in response_hook
    self._exception_handler.handle_exception(httpError.request, httpError.response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/custodian/lib/python3.13/site-packages/huaweicloudsdkcore/exceptions/exception_handler.py", line 75, in handle_exception
    raise exceptions.ClientRequestException(response.status_code, sdk_error) if response.status_code < 500 \
        else exceptions.ServerResponseException(response.status_code, sdk_error)
huaweicloudsdkcore.exceptions.exceptions.ClientRequestException: ClientRequestException - {status_code:401,request_id:4c9085200c71484ad66832f3e9419ad0,error_code:APIGW.0301,error_msg:Incorrect IAM authentication information: Unauthorized,encoded_authorization_message:None }

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/huawei_custodian/cloud-custodian/c7n/policy.py", line 330, in run
    resources = self.policy.resource_manager.resources()
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 153, in resources
    resources = self._fetch_resources(q)
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 172, in _fetch_resources
    return self.augment(self.source.get_resources(query)) or []
                        ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 74, in get_resources
    return self.query.filter(self.manager, **query)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 28, in filter
    resources = self._pagination_limit_offset(m, enum_op, path)
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 36, in _pagination_limit_offset
    client = session.client(m.service)
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/client.py", line 68, in client
    .build()
     ~~~~~^^
  File "/root/custodian/lib/python3.13/site-packages/huaweicloudsdkcore/client.py", line 197, in build
    self._credentials = self._credentials.process_auth_params(client.get_http_client(), self._region.id)
                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/custodian/lib/python3.13/site-packages/huaweicloudsdkcore/auth/credentials.py", line 293, in process_auth_params
    raise SdkException("Failed to get project id of region '%s' automatically, %s" % (region_id, e))
huaweicloudsdkcore.exceptions.exceptions.SdkException: SdkException - Failed to get project id of region 'cn-east-3' automatically, ClientRequestException - {status_code:401,request_id:4c9085200c71484ad66832f3e9419ad0,error_code:APIGW.0301,error_msg:Incorrect IAM authentication information: Unauthorized,encoded_authorization_message:None }
2025-03-22 11:35:12,933 - custodian.output - ERROR - Error while executing policy
Traceback (most recent call last):
  File "/root/custodian/lib/python3.13/site-packages/huaweicloudsdkcore/http/http_client.py", line 127, in response_hook
    resp.raise_for_status()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "/root/custodian/lib/python3.13/site-packages/requests/models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 401 Client Error: Unauthorized for url: https://iam.myhuaweicloud.com/v3/projects?name=ap-southeast-1

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/custodian/lib/python3.13/site-packages/huaweicloudsdkcore/auth/credentials.py", line 274, in process_auth_params
    response = http_client.do_request_sync(self.process_auth_request(req, http_client).result())
  File "/root/custodian/lib/python3.13/site-packages/huaweicloudsdkcore/http/http_client.py", line 100, in do_request_sync
    self.response_error_hook_factory()(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/root/custodian/lib/python3.13/site-packages/huaweicloudsdkcore/http/http_client.py", line 129, in response_hook
    self._exception_handler.handle_exception(httpError.request, httpError.response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/custodian/lib/python3.13/site-packages/huaweicloudsdkcore/exceptions/exception_handler.py", line 75, in handle_exception
    raise exceptions.ClientRequestException(response.status_code, sdk_error) if response.status_code < 500 \
        else exceptions.ServerResponseException(response.status_code, sdk_error)
huaweicloudsdkcore.exceptions.exceptions.ClientRequestException: ClientRequestException - {status_code:401,request_id:c1a9508d4bf34cd69c8c1dfaba38afc6,error_code:APIGW.0301,error_msg:Incorrect IAM authentication information: verify ak sk signature failed, canonical_request:GET|/v3/projects/|name=ap-southeast-1|host:iam.myhuaweicloud.com|user-agent:huaweicloud-usdk-python/3.0|x-sdk-date:20250322T033512Z||host;user-agent;x-sdk-date|e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855,encoded_authorization_message:None }

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/huawei_custodian/cloud-custodian/c7n/policy.py", line 330, in run
    resources = self.policy.resource_manager.resources()
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 153, in resources
    resources = self._fetch_resources(q)
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 172, in _fetch_resources
    return self.augment(self.source.get_resources(query)) or []
                        ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 74, in get_resources
    return self.query.filter(self.manager, **query)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 28, in filter
    resources = self._pagination_limit_offset(m, enum_op, path)
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 36, in _pagination_limit_offset
    client = session.client(m.service)
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/client.py", line 68, in client
    .build()
     ~~~~~^^
  File "/root/custodian/lib/python3.13/site-packages/huaweicloudsdkcore/client.py", line 197, in build
    self._credentials = self._credentials.process_auth_params(client.get_http_client(), self._region.id)
                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/custodian/lib/python3.13/site-packages/huaweicloudsdkcore/auth/credentials.py", line 293, in process_auth_params
    raise SdkException("Failed to get project id of region '%s' automatically, %s" % (region_id, e))
huaweicloudsdkcore.exceptions.exceptions.SdkException: SdkException - Failed to get project id of region 'ap-southeast-1' automatically, ClientRequestException - {status_code:401,request_id:c1a9508d4bf34cd69c8c1dfaba38afc6,error_code:APIGW.0301,error_msg:Incorrect IAM authentication information: verify ak sk signature failed, canonical_request:GET|/v3/projects/|name=ap-southeast-1|host:iam.myhuaweicloud.com|user-agent:huaweicloud-usdk-python/3.0|x-sdk-date:20250322T033512Z||host;user-agent;x-sdk-date|e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855,encoded_authorization_message:None }
2025-03-22 11:36:58,265 - custodian.output - ERROR - Error while executing policy
Traceback (most recent call last):
  File "/root/custodian/lib/python3.13/site-packages/huaweicloudsdkcore/http/http_client.py", line 127, in response_hook
    resp.raise_for_status()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "/root/custodian/lib/python3.13/site-packages/requests/models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 401 Client Error: Unauthorized for url: https://iam.myhuaweicloud.com/v3/projects?name=ap-southeast-1

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/custodian/lib/python3.13/site-packages/huaweicloudsdkcore/auth/credentials.py", line 274, in process_auth_params
    response = http_client.do_request_sync(self.process_auth_request(req, http_client).result())
  File "/root/custodian/lib/python3.13/site-packages/huaweicloudsdkcore/http/http_client.py", line 100, in do_request_sync
    self.response_error_hook_factory()(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/root/custodian/lib/python3.13/site-packages/huaweicloudsdkcore/http/http_client.py", line 129, in response_hook
    self._exception_handler.handle_exception(httpError.request, httpError.response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/custodian/lib/python3.13/site-packages/huaweicloudsdkcore/exceptions/exception_handler.py", line 75, in handle_exception
    raise exceptions.ClientRequestException(response.status_code, sdk_error) if response.status_code < 500 \
        else exceptions.ServerResponseException(response.status_code, sdk_error)
huaweicloudsdkcore.exceptions.exceptions.ClientRequestException: ClientRequestException - {status_code:401,request_id:b0d5d185c645a412217d51456c0c1494,error_code:APIGW.0301,error_msg:Incorrect IAM authentication information: verify ak sk signature failed, canonical_request:GET|/v3/projects/|name=ap-southeast-1|host:iam.myhuaweicloud.com|user-agent:huaweicloud-usdk-python/3.0|x-sdk-date:20250322T033657Z||host;user-agent;x-sdk-date|e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855,encoded_authorization_message:None }

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/huawei_custodian/cloud-custodian/c7n/policy.py", line 330, in run
    resources = self.policy.resource_manager.resources()
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 153, in resources
    resources = self._fetch_resources(q)
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 172, in _fetch_resources
    return self.augment(self.source.get_resources(query)) or []
                        ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 74, in get_resources
    return self.query.filter(self.manager, **query)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 28, in filter
    resources = self._pagination_limit_offset(m, enum_op, path)
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 36, in _pagination_limit_offset
    client = session.client(m.service)
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/client.py", line 68, in client
    .build()
     ~~~~~^^
  File "/root/custodian/lib/python3.13/site-packages/huaweicloudsdkcore/client.py", line 197, in build
    self._credentials = self._credentials.process_auth_params(client.get_http_client(), self._region.id)
                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/custodian/lib/python3.13/site-packages/huaweicloudsdkcore/auth/credentials.py", line 293, in process_auth_params
    raise SdkException("Failed to get project id of region '%s' automatically, %s" % (region_id, e))
huaweicloudsdkcore.exceptions.exceptions.SdkException: SdkException - Failed to get project id of region 'ap-southeast-1' automatically, ClientRequestException - {status_code:401,request_id:b0d5d185c645a412217d51456c0c1494,error_code:APIGW.0301,error_msg:Incorrect IAM authentication information: verify ak sk signature failed, canonical_request:GET|/v3/projects/|name=ap-southeast-1|host:iam.myhuaweicloud.com|user-agent:huaweicloud-usdk-python/3.0|x-sdk-date:20250322T033657Z||host;user-agent;x-sdk-date|e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855,encoded_authorization_message:None }
2025-03-22 11:47:51,183 - custodian.output - ERROR - Error while executing policy
Traceback (most recent call last):
  File "/root/custodian/lib/python3.13/site-packages/huaweicloudsdkcore/http/http_client.py", line 127, in response_hook
    resp.raise_for_status()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "/root/custodian/lib/python3.13/site-packages/requests/models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 401 Client Error: Unauthorized for url: https://iam.myhuaweicloud.com/v3/projects?name=ap-southeast-1

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/custodian/lib/python3.13/site-packages/huaweicloudsdkcore/auth/credentials.py", line 274, in process_auth_params
    response = http_client.do_request_sync(self.process_auth_request(req, http_client).result())
  File "/root/custodian/lib/python3.13/site-packages/huaweicloudsdkcore/http/http_client.py", line 100, in do_request_sync
    self.response_error_hook_factory()(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/root/custodian/lib/python3.13/site-packages/huaweicloudsdkcore/http/http_client.py", line 129, in response_hook
    self._exception_handler.handle_exception(httpError.request, httpError.response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/custodian/lib/python3.13/site-packages/huaweicloudsdkcore/exceptions/exception_handler.py", line 75, in handle_exception
    raise exceptions.ClientRequestException(response.status_code, sdk_error) if response.status_code < 500 \
        else exceptions.ServerResponseException(response.status_code, sdk_error)
huaweicloudsdkcore.exceptions.exceptions.ClientRequestException: ClientRequestException - {status_code:401,request_id:4f96aad8d9cb41fcfd01950bd7a0e337,error_code:APIGW.0301,error_msg:Incorrect IAM authentication information: verify ak sk signature failed, canonical_request:GET|/v3/projects/|name=ap-southeast-1|host:iam.myhuaweicloud.com|user-agent:huaweicloud-usdk-python/3.0|x-sdk-date:20250322T034750Z||host;user-agent;x-sdk-date|e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855,encoded_authorization_message:None }

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/huawei_custodian/cloud-custodian/c7n/policy.py", line 330, in run
    resources = self.policy.resource_manager.resources()
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 153, in resources
    resources = self._fetch_resources(q)
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 172, in _fetch_resources
    return self.augment(self.source.get_resources(query)) or []
                        ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 74, in get_resources
    return self.query.filter(self.manager, **query)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 28, in filter
    resources = self._pagination_limit_offset(m, enum_op, path)
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 36, in _pagination_limit_offset
    client = session.client(m.service)
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/client.py", line 68, in client
    .build()
     ~~~~~^^
  File "/root/custodian/lib/python3.13/site-packages/huaweicloudsdkcore/client.py", line 197, in build
    self._credentials = self._credentials.process_auth_params(client.get_http_client(), self._region.id)
                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/custodian/lib/python3.13/site-packages/huaweicloudsdkcore/auth/credentials.py", line 293, in process_auth_params
    raise SdkException("Failed to get project id of region '%s' automatically, %s" % (region_id, e))
huaweicloudsdkcore.exceptions.exceptions.SdkException: SdkException - Failed to get project id of region 'ap-southeast-1' automatically, ClientRequestException - {status_code:401,request_id:4f96aad8d9cb41fcfd01950bd7a0e337,error_code:APIGW.0301,error_msg:Incorrect IAM authentication information: verify ak sk signature failed, canonical_request:GET|/v3/projects/|name=ap-southeast-1|host:iam.myhuaweicloud.com|user-agent:huaweicloud-usdk-python/3.0|x-sdk-date:20250322T034750Z||host;user-agent;x-sdk-date|e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855,encoded_authorization_message:None }
2025-03-22 11:51:25,243 - custodian.output - ERROR - Error while executing policy
Traceback (most recent call last):
  File "/root/huawei_custodian/cloud-custodian/c7n/policy.py", line 330, in run
    resources = self.policy.resource_manager.resources()
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 153, in resources
    resources = self._fetch_resources(q)
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 172, in _fetch_resources
    return self.augment(self.source.get_resources(query)) or []
                        ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 74, in get_resources
    return self.query.filter(self.manager, **query)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 28, in filter
    resources = self._pagination_limit_offset(m, enum_op, path)
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 42, in _pagination_limit_offset
    request = session.request(m.service)
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/client.py", line 80, in request
    return request
           ^^^^^^^
UnboundLocalError: cannot access local variable 'request' where it is not associated with a value
2025-03-22 11:52:44,988 - custodian.output - ERROR - Error while executing policy
Traceback (most recent call last):
  File "/root/custodian/lib/python3.13/site-packages/huaweicloudsdkcore/http/http_client.py", line 127, in response_hook
    resp.raise_for_status()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "/root/custodian/lib/python3.13/site-packages/requests/models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 403 Client Error: Forbidden for url: https://cbr.ap-southeast-1.myhuaweicloud.com/v3/0d9da8861b80f5a32fb4c00645f2dbd7/backups?limit=100&offset=0

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/huawei_custodian/cloud-custodian/c7n/policy.py", line 330, in run
    resources = self.policy.resource_manager.resources()
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 153, in resources
    resources = self._fetch_resources(q)
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 172, in _fetch_resources
    return self.augment(self.source.get_resources(query)) or []
                        ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 74, in get_resources
    return self.query.filter(self.manager, **query)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 28, in filter
    resources = self._pagination_limit_offset(m, enum_op, path)
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 45, in _pagination_limit_offset
    response = self._invoke_client_enum(client, enum_op, request)
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 62, in _invoke_client_enum
    return getattr(client, enum_op)(request)
           ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/root/custodian/lib/python3.13/site-packages/huaweicloudsdkcbr/v1/cbr_client.py", line 1774, in list_backups
    return self._call_api(**http_info)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/root/custodian/lib/python3.13/site-packages/huaweicloudsdkcbr/v1/cbr_client.py", line 4792, in _call_api
    return self.do_http_request(**kwargs)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/root/custodian/lib/python3.13/site-packages/huaweicloudsdkcore/client.py", line 480, in do_http_request
    response = self._do_http_request_sync(request)
  File "/root/custodian/lib/python3.13/site-packages/huaweicloudsdkcore/client.py", line 531, in _do_http_request_sync
    response = self._http_client.do_request_sync(request)
  File "/root/custodian/lib/python3.13/site-packages/huaweicloudsdkcore/http/http_client.py", line 100, in do_request_sync
    self.response_error_hook_factory()(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/root/custodian/lib/python3.13/site-packages/huaweicloudsdkcore/http/http_client.py", line 129, in response_hook
    self._exception_handler.handle_exception(httpError.request, httpError.response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/custodian/lib/python3.13/site-packages/huaweicloudsdkcore/exceptions/exception_handler.py", line 75, in handle_exception
    raise exceptions.ClientRequestException(response.status_code, sdk_error) if response.status_code < 500 \
        else exceptions.ServerResponseException(response.status_code, sdk_error)
huaweicloudsdkcore.exceptions.exceptions.ClientRequestException: ClientRequestException - {status_code:403,request_id:8a7237a961d1d53da29cb88001c88a25,error_code:BackupService.0403,error_msg:User: iam::0ce6529de880f4ec0f14c006b0bb26c0:user:custodian is not authorized to perform: cbr:backups:list on resource: cbr:ap-southeast-1:0ce6529de880f4ec0f14c006b0bb26c0:backup:* because no identity-based policy allows the cbr:backups:list action.,encoded_authorization_message:Eg5hcC1zb3V0aGVhc3QtMRogMGNlNjUyOWRlODgwZjRlYzBmMTRjMDA2YjBiYjI2YzAggwYqDIQXRCMbbAJDlYzCUA==.YdfZ1lFXLX3hpHSNyGRSgofDC3/KJcAIQ/kJVDp1betIsf8H461wElqVo5xAREXJGjq0NtmzS+ejCCqzCQQG0R6+RMpxb43w/o+QfHvLtZ91kEIHZXS6hP2Im0hGVLlqa+KJz1BerbPLcp3j+weYYqxM/aroh+I0WHSqaGEFgE5X8OOHhGGLNwroZvKyl9V/7F63o1zmZa8OU+qjjvQjdU3J1xJszIzelF4FrfxZGfEcNXNESsah1ZKES6YyNA2XcC6Bp+w0Ncm6xTL3s/cBSe+kYzfQHQUH6fH3cAZoJOUrq2Zm80/wYSSnXSby4oUBekGutzVR7zfccOWM9Cv1fMEPLrktifjrzXKbQ3qOC9rabjsfJRONtFsVRhQqmZU5LuXnyx55/cDhOzEUZD/8UU28QSgYozEuB7p5ZFy6JDSxSqpEw6n0W2bGD8VvS5IDlRPYErs1BmGwLgUvo6b4smebk74gshwL8dDKo0szFsWdnOgAQLf5keO2m1JA4RhWWTwdJAydWRj3yB3qUc0oJeruiww8EbiXNzLWBrSvdeWk6r3RBPdwX0xmeVeOSATP9zfRWXpFSYbqnkUOTCpmCuyi5VYsJr62tpbDDI0+Ryz5j01ycjIB2IKfZAYZYpWBk145xhjk5lPHvelBjtGjAd8f1BBlDgoReg+VybrMUD3ViPidJVSYbebgVswA469bnegfqSGfK4CGIQ+fHz5J0xNjcJYf5mWjLdJc0OqgM50AmYKC7f8q2x8i45BeXTGed5SAWpt0eYnIW4eBkMpqkivY9GAlr1+L5t2wpz7TK0E2uXKyY2f1YErHyOtXgsPR10P1UIU8DqVWGsMZmbP51hj3RDm02IP9jpVGSP0KQDOjh5FJLOSgue9OY2djPk5hV3A8S9uvucmHwMt9bCT6LZogeWtPozFKr+h+tWTkCpNuHVGjVv0O61wm+xzGd+1Upwvuz0sEujuyV9vTGFfPAI7X2HgihTC6BvqejPsRv3f6kvjSaGN0SFbE/qcFRs1o8X6KpMHOwrr2Hile+YlX1ed2PUD2UJGl42i+2k7UYRIcF1AJk3rCV/X7E0weCLEWbLMgnMR87GwNwWaA2VP7d/RTyjE3UXfrV7hm7dDXvI0solilm0k5aokJREUCY3aahJg38gHcuAbYdfc7DeRrx0XANXRXL0DCCHV5J0DzRPkqcWMDiG9abU0/hGTC49tWDOgWsODPUc9nncxdpnOBgc5sc6i2m5zud47e3AdfrkidH0rylIcNp7AFOSLryzjECQPAxMlmbFhNzOD6NT0A5c1Xd4Jocj1evRbJfLJTDcoGhJgP+Z9ATlBnodhCTUMuVj3cqEq35/VpyFwZli6j/JBhqOdHoMcx4w0EwGS+bPh1bvJVb1bcTS6HKFp2v2PavdRayZtSm48gZa2w0EQwdoLCNZvWf6Or68TmIz9xvvMevhI47OWC6ltotgUb8gz8T8uQogsahEASegkDoN0+oReHjCqtEZL0DNh0ed14poJNrHw1T1RQEZQ/6o+ZQ+RLkp1n/FZ9DVeWhYtxZwP7VlXbNfEI5+LF+8JK22OHMhUtkIQzuP8L54pW/lWZictfKZbnpc4HwzhUXOVP3/9+v5BW4Shjv6w35F3DXw66knpCpZNFfYRfct3YOklGyBCJDF5S5HzF8+KkLCwj8Sm6AQAEAxsSQP1fLzGVFVy2KjU615UBzkBuP8sN/jF0kQmLCbG5a9fwm9DLhzxe9W+zI6pAmqLv9+pLDbmY0lEkUlVUGk2MKqWcvifYVhjlKLmZfNvuG4ntPJvymq2cgAbWoC3RTibdNkUWgtKc9fEgPAf/q7dOSKeyJqPEDjQarwhz8niL5TbtYuAea9UF/QI+tGz5e5MugHJjaGjCDAKCYxMPgqPThA/f43XQlFca8Z9Au9cTwYHZQDDGZ4yrodbntFuF9BqYC6KMoZb16dQOFozQQ/e1q7C8eZCm64E2K7iX/w0=.QxXdE6WrJsgl6OhNl22eIQ== }
2025-03-22 11:55:01,854 - custodian.output - ERROR - Error while executing policy
Traceback (most recent call last):
  File "/root/custodian/lib/python3.13/site-packages/huaweicloudsdkcore/http/http_client.py", line 127, in response_hook
    resp.raise_for_status()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "/root/custodian/lib/python3.13/site-packages/requests/models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 403 Client Error: Forbidden for url: https://cbr.ap-southeast-1.myhuaweicloud.com/v3/0d9da8861b80f5a32fb4c00645f2dbd7/backups?limit=100&offset=0

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/huawei_custodian/cloud-custodian/c7n/policy.py", line 330, in run
    resources = self.policy.resource_manager.resources()
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 153, in resources
    resources = self._fetch_resources(q)
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 172, in _fetch_resources
    return self.augment(self.source.get_resources(query)) or []
                        ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 74, in get_resources
    return self.query.filter(self.manager, **query)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 28, in filter
    resources = self._pagination_limit_offset(m, enum_op, path)
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 45, in _pagination_limit_offset
    response = self._invoke_client_enum(client, enum_op, request)
  File "/root/huawei_custodian/cloud-custodian/tools/c7n_huaweicloud/c7n_huaweicloud/query.py", line 62, in _invoke_client_enum
    return getattr(client, enum_op)(request)
           ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/root/custodian/lib/python3.13/site-packages/huaweicloudsdkcbr/v1/cbr_client.py", line 1774, in list_backups
    return self._call_api(**http_info)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/root/custodian/lib/python3.13/site-packages/huaweicloudsdkcbr/v1/cbr_client.py", line 4792, in _call_api
    return self.do_http_request(**kwargs)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/root/custodian/lib/python3.13/site-packages/huaweicloudsdkcore/client.py", line 480, in do_http_request
    response = self._do_http_request_sync(request)
  File "/root/custodian/lib/python3.13/site-packages/huaweicloudsdkcore/client.py", line 531, in _do_http_request_sync
    response = self._http_client.do_request_sync(request)
  File "/root/custodian/lib/python3.13/site-packages/huaweicloudsdkcore/http/http_client.py", line 100, in do_request_sync
    self.response_error_hook_factory()(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/root/custodian/lib/python3.13/site-packages/huaweicloudsdkcore/http/http_client.py", line 129, in response_hook
    self._exception_handler.handle_exception(httpError.request, httpError.response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/custodian/lib/python3.13/site-packages/huaweicloudsdkcore/exceptions/exception_handler.py", line 75, in handle_exception
    raise exceptions.ClientRequestException(response.status_code, sdk_error) if response.status_code < 500 \
        else exceptions.ServerResponseException(response.status_code, sdk_error)
huaweicloudsdkcore.exceptions.exceptions.ClientRequestException: ClientRequestException - {status_code:403,request_id:02b1c304c3ffc962b3f2ac7388f9bc5a,error_code:BackupService.0403,error_msg:User: iam::0ce6529de880f4ec0f14c006b0bb26c0:user:custodian is not authorized to perform: cbr:backups:list on resource: cbr:ap-southeast-1:0ce6529de880f4ec0f14c006b0bb26c0:backup:* because no identity-based policy allows the cbr:backups:list action.,encoded_authorization_message:Eg5hcC1zb3V0aGVhc3QtMRogMGNlNjUyOWRlODgwZjRlYzBmMTRjMDA2YjBiYjI2YzAggwYqDKDvNKW06/HEXqH/sw==.kUA8WXXqkrgPRV/MwQ8nphqkMmHcvc1Ibmv2RcBtgPWMHHsTwTnqnYU5myieEre/I04mBAGEwCl7aeGFOJC3/a3LoW4JKHc0ByjvEPLuNNvSOysTqFGdE//LDIP97bULzSXP9gbI7wH0cTT8vdm5hwGjpzHpbsFhfCx8GEGXstWYo8DQbbKB6UMT+OSqBLsBSpEm3CH11tluOWGt8vNvJBH8B+i6u6A+Dvi7JuXvWaw57URnw+jou5+RbXQUBL2IqTVmBl5CZge/XhOunp0XLZqdHzfxOxl30ULbgbMvDfaFkWx308KE/pMOzY18yvC3KZFp8RIgwzUIxviBm2jqJqpo+w8Hslu3rIw4KB5N6pls2Q+hVxR6r10ETXsLAcXqsT2gh3YC7fHfccEpiuHezgrZRfnNtr8KwgFKT2DChUfhXcEsUdcPpjZBnYQhiyCYdXcXkku4Y2jRqmjZK45iEQt7wti3+8qEmVESE8INlupUnqmOZDSC/dLLOeddVgvN0PJV0CvrU8rfvAR5fgl9ZPN51HW3h8/qIcI2zmQkkU2SnNiBuVaPDmlE/zUml8vHPg2ly+lESlNgVdoQvLX727k6/igsB/wt8j9u2SAQUHNljlmI2T18Bqr0oIl7s4jOw74Ujt7zQFn1k3aa6dOglMlTyHeIErGhpUJ/oAT4uoc+jknFiw3A8fCOd75WxNbLS3UrmRBOBai9N3WoAHRc8wI/nRRbztzZbF/V6Sm+PaFWKi2XcTsNqadgisIBwGrH7zeSUB4dedW1TZuxFZ/n6wD7gj4Wbu680mClxgAbiWjbUHT5KAGSm1NnxdTSf3wlPDB6L5KLp5+cHyQr2k9s6UA2aMRxFySmpXqAFHf1L/uuS6Vb4Cdn5yAK2tjIzXJ4y16EzLEN+AVNhqqIlRTFDj7PBoMyR1cATq61u7sFS2InwMNptfsnzL7kc2wsvJHl9QhhFpqVyWNLI0HSZb5LejbaHgGDB1O+4bfF8dKRP30Z3OcU5jk2U0GhCS6gQeTSngYB6rFqs550BjxzPzp0+swZ92J8VKWhaESjFK8/iWAnpUL/RswlmzaygZ51F8RLgRG0DV020fXs95n7lI+hF2xolpba2q38ZqfmulwO2WqurGPrlH/zR/NuYvqg0zqHajqkCBIY86gcfbCRoPAryrp2tVByFuxqF4sB2ts1FAWehSX9tYkkHucfycReyJyyporF9mSS+ZfGsHt8QAEOrAHc6fTiMErcvviv5dgwul11Mqu2TyKMT6rV5SK5hjZ7wVuWc7Wr0Ge/iM+fZS4fEw0yCdQkGtU8BYWWEnw9jgiQf/lMdhJhLxf0Q/GBTpqXBfrvKipG9bmi82in58kix5LSSQcuCQ3uHpKJvuvAfo44Ph6LhwDUx/gi14f9frsrTsq9Aw7T6VXcruk3ZFXO1c2kOFEFruvdRacryw8BmuQGF+ibASYKTKQ6jMqBqMgqqhJVVD4c2JHYpjNA1DpT8yYLCWIMdpY0j9hkbvDKNKjCMKe3kk0RlZRqCCRiOSulx63NWHhbgMSCROyf3HkFwG1fA/bxjQpC2dL0H60Q3CvLMRCf2qiQzwUCDaZA5A+59eP+iCWU92iRVHBE1ApwCJymtpYSnYTU5HCPn6kAmW7GzDGNugZEhRvvzwaybcJzuZQ47NCXX7IMqvgAQC74Kv102P1EVXWYFDuj07qrQoaGM5uA9BtblocsYQtpE+s+aEUkRWPQ6Ekpm31QW7ThhjC+ujxF/IjzkddcSzFu1phISlVpg7yh4BmIUGPgeDfHt6awNT4KIxrvlJ2qzd+gTxg5X5A/zTi/V4XS112teY703xOT51sCWPqokh/yslYr2qoe5Tzh4mfkZUzR0KSWJ/KcDmmUz+CAW27aMFKYuaWMq9T+8C/Ol2kLwYuy5L2bOryAc36ScKiH3iEPGJJD4IC56/UpQZQR9JwK1ABNht5rGu9GMWaxkoaQcwzmUDVrGu0=.OHXFf7AZ0Ow8MsRDuTzlRA== }
2025-03-22 11:59:52,326 - custodian.policy - INFO - policy:update_policy_unprotected resource:huaweicloud.cbr-backup region: count:0 time:1.00
2025-03-22 16:14:09,197 - custodian.policy - INFO - policy:update_policy_unprotected resource:huaweicloud.cbr-vault region: count:0 time:0.00
